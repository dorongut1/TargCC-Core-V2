// <auto-generated>
//     This code was generated by TargCC Component Generator.
//     Table: CustomerCardTransaction
//     Generated: 2025-12-17 12:56:56
// </auto-generated>

import React, { useEffect } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { useForm } from 'react-hook-form';
import { TextField, Button, Box, CircularProgress, Checkbox, FormControlLabel } from '@mui/material';
import { useCustomerCardTransaction, useCreateCustomerCardTransaction, useUpdateCustomerCardTransaction } from '../../hooks/useCustomerCardTransaction';
import type { CreateCustomerCardTransactionRequest, UpdateCustomerCardTransactionRequest } from '../../types/CustomerCardTransaction.types';


export const CustomerCardTransactionForm: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const customerCardTransactionId = id && id !== 'new' ? Number(id) : undefined;
  const isEdit = !!customerCardTransactionId;

  const { data: existingCustomerCardTransaction, isPending: isLoadingEntity } = useCustomerCardTransaction(customerCardTransactionId || null);

  const {
    register,
    handleSubmit,
    reset,
    formState: { errors },
  } = useForm<CreateCustomerCardTransactionRequest>({
    defaultValues: {
    },
  });

  // Update form when data loads
  useEffect(() => {
    if (existingCustomerCardTransaction) {
      reset(existingCustomerCardTransaction);
    }
  }, [existingCustomerCardTransaction, reset]);

  const { mutate: createEntity, isPending: isCreating } = useCreateCustomerCardTransaction();
  const { mutate: updateEntity, isPending: isUpdating } = useUpdateCustomerCardTransaction();

  const isSubmitting = isCreating || isUpdating;

  const onSubmit = (data: CreateCustomerCardTransactionRequest) => {
    if (isEdit && customerCardTransactionId) {
      updateEntity(
        { id: customerCardTransactionId, data: data as UpdateCustomerCardTransactionRequest },
        { onSuccess: () => navigate('/customerCardTransactions') }
      );
    } else {
      createEntity(data, { onSuccess: () => navigate('/customerCardTransactions') });
    }
  };

  if (isEdit && isLoadingEntity) {
    return <CircularProgress />;
  }

  return (
    <Box component="form" onSubmit={handleSubmit(onSubmit)} sx={{ maxWidth: 600 }}>
      <TextField
        label="FileName"
        type="text"
        fullWidth
        margin="normal"
        {...register('fileName', { required: 'FileName is required', maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.fileName}
        helperText={errors.fileName?.message}
      />

      <TextField
        label="RowNumberInFile"
        type="number"
        fullWidth
        margin="normal"
        {...register('rowNumberInFile', { required: 'RowNumberInFile is required', maxLength: { value: 4, message: 'Maximum length is 4' } })}
        error={!!errors.rowNumberInFile}
        helperText={errors.rowNumberInFile?.message}
      />

      <TextField
        label="CustomerID"
        type="number"
        fullWidth
        margin="normal"
        {...register('customerID', { required: 'CustomerID is required', maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.customerID}
        helperText={errors.customerID?.message}
      />

      <TextField
        label="CardID"
        type="number"
        fullWidth
        margin="normal"
        {...register('cardID', { required: 'CardID is required', maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.cardID}
        helperText={errors.cardID?.message}
      />

      <TextField
        label="Date"
        type="date"
        fullWidth
        margin="normal"
        InputLabelProps={{ shrink: true }}
        {...register('date', { required: 'Date is required', maxLength: { value: 3, message: 'Maximum length is 3' } })}
        error={!!errors.date}
        helperText={errors.date?.message}
      />

      <TextField
        label="WhenApproved"
        type="date"
        fullWidth
        margin="normal"
        InputLabelProps={{ shrink: true }}
        {...register('whenApproved', { maxLength: { value: 10, message: 'Maximum length is 10' } })}
        error={!!errors.whenApproved}
        helperText={errors.whenApproved?.message}
      />

      <TextField
        label="ApprovalCode"
        type="text"
        fullWidth
        margin="normal"
        {...register('approvalCode', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.approvalCode}
        helperText={errors.approvalCode?.message}
      />

      <TextField
        label="TransactionType"
        type="text"
        fullWidth
        margin="normal"
        {...register('transactionType', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.transactionType}
        helperText={errors.transactionType?.message}
      />

      <TextField
        label="CardUseMethod"
        type="text"
        fullWidth
        margin="normal"
        {...register('cardUseMethod', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.cardUseMethod}
        helperText={errors.cardUseMethod?.message}
      />

      <TextField
        label="EstablishmentName"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentName', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.establishmentName}
        helperText={errors.establishmentName?.message}
      />

      <TextField
        label="EstablishmentEnglishName"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentEnglishName', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.establishmentEnglishName}
        helperText={errors.establishmentEnglishName?.message}
      />

      <TextField
        label="LkpMerchantCategory"
        type="number"
        fullWidth
        margin="normal"
        {...register('lkpMerchantCategory', { maxLength: { value: 4, message: 'Maximum length is 4' } })}
        error={!!errors.lkpMerchantCategory}
        helperText={errors.lkpMerchantCategory?.message}
      />

      <TextField
        label="Currency"
        type="text"
        fullWidth
        margin="normal"
        {...register('currency', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.currency}
        helperText={errors.currency?.message}
      />

      <TextField
        label="ExchangeRateUsed"
        type="number"
        fullWidth
        margin="normal"
        {...register('exchangeRateUsed', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.exchangeRateUsed}
        helperText={errors.exchangeRateUsed?.message}
      />

      <TextField
        label="AmountInLocalCurrency"
        type="number"
        fullWidth
        margin="normal"
        {...register('amountInLocalCurrency', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.amountInLocalCurrency}
        helperText={errors.amountInLocalCurrency?.message}
      />

      <TextField
        label="AmountInCardCurrency"
        type="number"
        fullWidth
        margin="normal"
        {...register('amountInCardCurrency', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.amountInCardCurrency}
        helperText={errors.amountInCardCurrency?.message}
      />

      <TextField
        label="Vat"
        type="number"
        fullWidth
        margin="normal"
        {...register('vat', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.vat}
        helperText={errors.vat?.message}
      />

      <TextField
        label="Commission"
        type="number"
        fullWidth
        margin="normal"
        {...register('commission', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.commission}
        helperText={errors.commission?.message}
      />

      <TextField
        label="EstablishmentAddress"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentAddress', { maxLength: { value: 200, message: 'Maximum length is 200' } })}
        error={!!errors.establishmentAddress}
        helperText={errors.establishmentAddress?.message}
      />

      <TextField
        label="EstablishmentCity"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentCity', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.establishmentCity}
        helperText={errors.establishmentCity?.message}
      />

      <TextField
        label="EstablishmentCountry"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentCountry', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.establishmentCountry}
        helperText={errors.establishmentCountry?.message}
      />

      <TextField
        label="EstablishmentLocation"
        type="text"
        fullWidth
        margin="normal"
        {...register('establishmentLocation', {  })}
        error={!!errors.establishmentLocation}
        helperText={errors.establishmentLocation?.message}
      />

      <FormControlLabel
        control={<Checkbox {...register('isEMV')} />}
        label="IsEMV"
      />

      <TextField
        label="IsContested"
        fullWidth
        margin="normal"
        {...register('isContested', { maxLength: { value: 1, message: 'Maximum length is 1' } })}
        error={!!errors.isContested}
        helperText={errors.isContested?.message}
      />

      <TextField
        label="ClientPayment"
        type="number"
        fullWidth
        margin="normal"
        {...register('clientPayment', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.clientPayment}
        helperText={errors.clientPayment?.message}
      />

      <TextField
        label="ICPPayment"
        type="number"
        fullWidth
        margin="normal"
        {...register('iCPPayment', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.iCPPayment}
        helperText={errors.iCPPayment?.message}
      />

      <TextField
        label="DistributorPayment"
        type="number"
        fullWidth
        margin="normal"
        {...register('distributorPayment', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.distributorPayment}
        helperText={errors.distributorPayment?.message}
      />

      <TextField
        label="ICPProfit"
        type="number"
        fullWidth
        margin="normal"
        {...register('iCPProfit', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.iCPProfit}
        helperText={errors.iCPProfit?.message}
      />

      <TextField
        label="EnmUpayCardTransactionTypeCustomerTransactionType"
        type="text"
        fullWidth
        margin="normal"
        {...register('enmUpayCardTransactionTypeCustomerTransactionType', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.enmUpayCardTransactionTypeCustomerTransactionType}
        helperText={errors.enmUpayCardTransactionTypeCustomerTransactionType?.message}
      />

      <TextField
        label="CHBRefused"
        fullWidth
        margin="normal"
        {...register('cHBRefused', { maxLength: { value: 1, message: 'Maximum length is 1' } })}
        error={!!errors.cHBRefused}
        helperText={errors.cHBRefused?.message}
      />

      <TextField
        label="ClientCHBFee"
        type="number"
        fullWidth
        margin="normal"
        {...register('clientCHBFee', { maxLength: { value: 9, message: 'Maximum length is 9' } })}
        error={!!errors.clientCHBFee}
        helperText={errors.clientCHBFee?.message}
      />

      <TextField
        label="Comment"
        fullWidth
        margin="normal"
        {...register('comment', {  })}
        error={!!errors.comment}
        helperText={errors.comment?.message}
      />

      <TextField
        label="DeletedBy"
        type="text"
        fullWidth
        margin="normal"
        {...register('deletedBy', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.deletedBy}
        helperText={errors.deletedBy?.message}
      />

      <TextField
        label="DeletedOn"
        type="date"
        fullWidth
        margin="normal"
        InputLabelProps={{ shrink: true }}
        {...register('deletedOn', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.deletedOn}
        helperText={errors.deletedOn?.message}
      />

      <TextField
        label="UpdatingLoginID"
        type="number"
        fullWidth
        margin="normal"
        {...register('updatingLoginID', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.updatingLoginID}
        helperText={errors.updatingLoginID?.message}
      />

      <TextField
        label="LgOwningDistributorID"
        type="number"
        fullWidth
        margin="normal"
        {...register('lgOwningDistributorID', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.lgOwningDistributorID}
        helperText={errors.lgOwningDistributorID?.message}
      />

      <TextField
        label="CardCid"
        type="text"
        fullWidth
        margin="normal"
        {...register('cardCid', { maxLength: { value: 10, message: 'Maximum length is 10' } })}
        error={!!errors.cardCid}
        helperText={errors.cardCid?.message}
      />

      <TextField
        label="OrgCode"
        type="text"
        fullWidth
        margin="normal"
        {...register('orgCode', { maxLength: { value: 10, message: 'Maximum length is 10' } })}
        error={!!errors.orgCode}
        helperText={errors.orgCode?.message}
      />

      <Box sx={{ my: 2 }}>
        <Button variant="outlined" component="label">
          Upload Receipt
          <input type="file" hidden {...register('receipt')} />
        </Button>
      </Box>

      <TextField
        label="LgCardClubID"
        type="number"
        fullWidth
        margin="normal"
        {...register('lgCardClubID', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.lgCardClubID}
        helperText={errors.lgCardClubID?.message}
      />



      <Box sx={{ mt: 2, display: 'flex', gap: 2 }}>
        <Button type="submit" variant="contained" disabled={isSubmitting}>
          {isEdit ? 'Update' : 'Create'}
        </Button>
        <Button variant="outlined" onClick={() => navigate('/customerCardTransactions')}>
          Cancel
        </Button>
      </Box>
    </Box>
  );
};

