// <auto-generated>
//     This code was generated by TargCC Component Generator.
//     Table: c_LoggedAlert
//     Generated: 2025-12-17 07:22:06
// </auto-generated>

import React, { useEffect } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { useForm } from 'react-hook-form';
import { TextField, Button, Box, CircularProgress } from '@mui/material';
import { useLoggedAlert, useCreateLoggedAlert, useUpdateLoggedAlert } from '../../hooks/useLoggedAlert';
import type { CreateLoggedAlertRequest, UpdateLoggedAlertRequest } from '../../types/LoggedAlert.types';


export const LoggedAlertForm: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const loggedAlertId = id && id !== 'new' ? Number(id) : undefined;
  const isEdit = !!loggedAlertId;

  const { data: existingLoggedAlert, isPending: isLoadingEntity } = useLoggedAlert(loggedAlertId || null);

  const {
    register,
    handleSubmit,
    reset,
    formState: { errors },
  } = useForm<CreateLoggedAlertRequest>({
    defaultValues: {
    },
  });

  // Update form when data loads
  useEffect(() => {
    if (existingLoggedAlert) {
      reset(existingLoggedAlert);
    }
  }, [existingLoggedAlert, reset]);

  const { mutate: createEntity, isPending: isCreating } = useCreateLoggedAlert();
  const { mutate: updateEntity, isPending: isUpdating } = useUpdateLoggedAlert();

  const isSubmitting = isCreating || isUpdating;

  const onSubmit = (data: CreateLoggedAlertRequest) => {
    if (isEdit && loggedAlertId) {
      updateEntity(
        { id: loggedAlertId, data: data as UpdateLoggedAlertRequest },
        { onSuccess: () => navigate('/loggedAlerts') }
      );
    } else {
      createEntity(data, { onSuccess: () => navigate('/loggedAlerts') });
    }
  };

  if (isEdit && isLoadingEntity) {
    return <CircularProgress />;
  }

  return (
    <Box component="form" onSubmit={handleSubmit(onSubmit)} sx={{ maxWidth: 600 }}>
      <TextField
        label="TimeOccurred"
        type="date"
        fullWidth
        margin="normal"
        InputLabelProps={{ shrink: true }}
        {...register('timeOccurred', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.timeOccurred}
        helperText={errors.timeOccurred?.message}
      />

      <TextField
        label="FaultNumber"
        type="number"
        fullWidth
        margin="normal"
        {...register('faultNumber', { maxLength: { value: 4, message: 'Maximum length is 4' } })}
        error={!!errors.faultNumber}
        helperText={errors.faultNumber?.message}
      />

      <TextField
        label="SystemName"
        type="text"
        fullWidth
        margin="normal"
        {...register('systemName', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.systemName}
        helperText={errors.systemName?.message}
      />

      <TextField
        label="CallingApplication"
        type="text"
        fullWidth
        margin="normal"
        {...register('callingApplication', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.callingApplication}
        helperText={errors.callingApplication?.message}
      />

      <TextField
        label="AffectedUserID"
        type="number"
        fullWidth
        margin="normal"
        {...register('affectedUserID', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.affectedUserID}
        helperText={errors.affectedUserID?.message}
      />

      <TextField
        label="CallingApplicationVersion"
        type="text"
        fullWidth
        margin="normal"
        {...register('callingApplicationVersion', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.callingApplicationVersion}
        helperText={errors.callingApplicationVersion?.message}
      />

      <TextField
        label="CallingFunctionWithinApplication"
        type="text"
        fullWidth
        margin="normal"
        {...register('callingFunctionWithinApplication', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.callingFunctionWithinApplication}
        helperText={errors.callingFunctionWithinApplication?.message}
      />

      <TextField
        label="FreeText"
        type="text"
        fullWidth
        margin="normal"
        {...register('freeText', {  })}
        error={!!errors.freeText}
        helperText={errors.freeText?.message}
      />

      <TextField
        label="FaultingAssembly"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultingAssembly', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.faultingAssembly}
        helperText={errors.faultingAssembly?.message}
      />

      <TextField
        label="AssemblyEntryPoint"
        type="text"
        fullWidth
        margin="normal"
        {...register('assemblyEntryPoint', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.assemblyEntryPoint}
        helperText={errors.assemblyEntryPoint?.message}
      />

      <TextField
        label="FaultingClass"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultingClass', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.faultingClass}
        helperText={errors.faultingClass?.message}
      />

      <TextField
        label="FaultingFunction"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultingFunction', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.faultingFunction}
        helperText={errors.faultingFunction?.message}
      />

      <TextField
        label="FaultingFunctionParameters"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultingFunctionParameters', {  })}
        error={!!errors.faultingFunctionParameters}
        helperText={errors.faultingFunctionParameters?.message}
      />

      <TextField
        label="FaultIdent"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultIdent', { maxLength: { value: 100, message: 'Maximum length is 100' } })}
        error={!!errors.faultIdent}
        helperText={errors.faultIdent?.message}
      />

      <TextField
        label="FaultDescription"
        type="text"
        fullWidth
        margin="normal"
        {...register('faultDescription', { maxLength: { value: 200, message: 'Maximum length is 200' } })}
        error={!!errors.faultDescription}
        helperText={errors.faultDescription?.message}
      />

      <TextField
        label="MessageSentToUser"
        type="text"
        fullWidth
        margin="normal"
        {...register('messageSentToUser', { maxLength: { value: 200, message: 'Maximum length is 200' } })}
        error={!!errors.messageSentToUser}
        helperText={errors.messageSentToUser?.message}
      />

      <TextField
        label="ActionSentToUser"
        type="text"
        fullWidth
        margin="normal"
        {...register('actionSentToUser', { maxLength: { value: 400, message: 'Maximum length is 400' } })}
        error={!!errors.actionSentToUser}
        helperText={errors.actionSentToUser?.message}
      />

      <TextField
        label="EnmFaultTypeFaultType"
        type="text"
        fullWidth
        margin="normal"
        {...register('enmFaultTypeFaultType', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.enmFaultTypeFaultType}
        helperText={errors.enmFaultTypeFaultType?.message}
      />

      <TextField
        label="EnmFaultSeverityFaultSeverity"
        type="text"
        fullWidth
        margin="normal"
        {...register('enmFaultSeverityFaultSeverity', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.enmFaultSeverityFaultSeverity}
        helperText={errors.enmFaultSeverityFaultSeverity?.message}
      />

      <TextField
        label="CLoggedLoginID"
        type="number"
        fullWidth
        margin="normal"
        {...register('cLoggedLoginID', { maxLength: { value: 8, message: 'Maximum length is 8' } })}
        error={!!errors.cLoggedLoginID}
        helperText={errors.cLoggedLoginID?.message}
      />

      <TextField
        label="Thread"
        type="text"
        fullWidth
        margin="normal"
        {...register('thread', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.thread}
        helperText={errors.thread?.message}
      />

      <TextField
        label="LkpUserIdentityType"
        type="text"
        fullWidth
        margin="normal"
        {...register('lkpUserIdentityType', { maxLength: { value: 50, message: 'Maximum length is 50' } })}
        error={!!errors.lkpUserIdentityType}
        helperText={errors.lkpUserIdentityType?.message}
      />

      <TextField
        label="LkpUserIdentityTypeName"
        type="number"
        fullWidth
        margin="normal"
        {...register('lkpUserIdentityTypeName', { maxLength: { value: 4, message: 'Maximum length is 4' } })}
        error={!!errors.lkpUserIdentityTypeName}
        helperText={errors.lkpUserIdentityTypeName?.message}
      />



      <Box sx={{ mt: 2, display: 'flex', gap: 2 }}>
        <Button type="submit" variant="contained" disabled={isSubmitting}>
          {isEdit ? 'Update' : 'Create'}
        </Button>
        <Button variant="outlined" onClick={() => navigate('/loggedAlerts')}>
          Cancel
        </Button>
      </Box>
    </Box>
  );
};

