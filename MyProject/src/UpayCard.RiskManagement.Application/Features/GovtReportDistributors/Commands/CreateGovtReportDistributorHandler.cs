// <auto-generated>
//     This code was generated by TargCC
//     Generated for: GovtReportDistributor (Handler)
//     Generation date: 2025-12-17 14:08:26
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

using MediatR;
using Microsoft.Extensions.Logging;
using UpayCard.RiskManagement.Application.Common.Models;
using UpayCard.RiskManagement.Domain.Entities;
using UpayCard.RiskManagement.Domain.Interfaces;

namespace UpayCard.RiskManagement.Application.Features.GovtReportDistributors.Commands;

/// <summary>
/// Handles the CreateGovtReportDistributorCommand request.
/// </summary>
public class CreateGovtReportDistributorHandler : IRequestHandler<CreateGovtReportDistributorCommand, Result<long>>
{
    private readonly IGovtReportDistributorRepository _repository;
    private readonly ILogger<CreateGovtReportDistributorHandler> _logger;

    /// <summary>
    /// Initializes a new instance of the <see cref="CreateGovtReportDistributorHandler"/> class.
    /// </summary>
    public CreateGovtReportDistributorHandler(
        IGovtReportDistributorRepository repository,
        ILogger<CreateGovtReportDistributorHandler> logger)
    {
        _repository = repository ?? throw new ArgumentNullException(nameof(repository));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public async Task<Result<long>> Handle(CreateGovtReportDistributorCommand request, CancellationToken cancellationToken)
    {
        ArgumentNullException.ThrowIfNull(request);

        _logger.LogDebug("Creating new GovtReportDistributor");

        try
        {
            var entity = new GovtReportDistributor
            {
                TableName_GovtReportDistributor = request.TableName_GovtReportDistributor,
                DistributorID = request.DistributorID,
                ReportFullName = request.ReportFullName,
                ReportIdentityNo = request.ReportIdentityNo,
                ReportBirthOrIncorporationDate = request.ReportBirthOrIncorporationDate,
                lkpReportGender = request.lkpReportGender,
                ReportTelephoneAreaCode = request.ReportTelephoneAreaCode,
                ReportTelephonePhoneNumber = request.ReportTelephonePhoneNumber,
                ReportFaxOrEmail = request.ReportFaxOrEmail,
                ReportAddress01Street = request.ReportAddress01Street,
                ReportAddress01House = request.ReportAddress01House,
                ReportAddress01City = request.ReportAddress01City,
                ReportAddress01Zip = request.ReportAddress01Zip,
                ReportFirstName = request.ReportFirstName,
                ReportSurnameOrCompanyname = request.ReportSurnameOrCompanyname,
                ReportCellPhoneAreaCode = request.ReportCellPhoneAreaCode,
                ReportCellPhoneNumber = request.ReportCellPhoneNumber,
                ReportStreetCode = request.ReportStreetCode,
                ReportCityCode = request.ReportCityCode,
                ReportS01FullName = request.ReportS01FullName,
                ReportS01IdentityNo = request.ReportS01IdentityNo,
                ReportS01BirthOrIncorporationDate = request.ReportS01BirthOrIncorporationDate,
                lkpReportS01Gender_ReportGender = request.lkpReportS01Gender_ReportGender,
                ReportS01TelephoneAreaCode = request.ReportS01TelephoneAreaCode,
                ReportS01TelephonePhoneNumber = request.ReportS01TelephonePhoneNumber,
                ReportS01FaxOrEmail = request.ReportS01FaxOrEmail,
                ReportS01Address01Street = request.ReportS01Address01Street,
                ReportS01Address01House = request.ReportS01Address01House,
                ReportS01Address01City = request.ReportS01Address01City,
                ReportS01Address01Zip = request.ReportS01Address01Zip,
                ReportS01FirstName = request.ReportS01FirstName,
                ReportS01SurnameOrCompanyname = request.ReportS01SurnameOrCompanyname,
                ReportS01CellPhoneAreaCode = request.ReportS01CellPhoneAreaCode,
                ReportS01CellPhoneNumber = request.ReportS01CellPhoneNumber,
                ReportS01StreetCode = request.ReportS01StreetCode,
                ReportS01CityCode = request.ReportS01CityCode,
                ReportS02FullName = request.ReportS02FullName,
                ReportS02IdentityNo = request.ReportS02IdentityNo,
                ReportS02BirthOrIncorporationDate = request.ReportS02BirthOrIncorporationDate,
                lkpReportS02Gender_ReportGender = request.lkpReportS02Gender_ReportGender,
                ReportS02TelephoneAreaCode = request.ReportS02TelephoneAreaCode,
                ReportS02TelephonePhoneNumber = request.ReportS02TelephonePhoneNumber,
                ReportS02FaxOrEmail = request.ReportS02FaxOrEmail,
                ReportS02Address01Street = request.ReportS02Address01Street,
                ReportS02Address01House = request.ReportS02Address01House,
                ReportS02Address01City = request.ReportS02Address01City,
                ReportS02Address01Zip = request.ReportS02Address01Zip,
                ReportS02FirstName = request.ReportS02FirstName,
                ReportS02SurnameOrCompanyname = request.ReportS02SurnameOrCompanyname,
                ReportS02CellPhoneAreaCode = request.ReportS02CellPhoneAreaCode,
                ReportS02CellPhoneNumber = request.ReportS02CellPhoneNumber,
                ReportS02StreetCode = request.ReportS02StreetCode,
                ReportS02CityCode = request.ReportS02CityCode,
                DeletedBy = request.DeletedBy,
                DeletedOn = request.DeletedOn,
                UpdatingLoginID = request.UpdatingLoginID,
                lkpIdentityNoType = request.lkpIdentityNoType,
                IsPublicBenefitCompany = request.IsPublicBenefitCompany
            };

            await _repository.AddAsync(entity, cancellationToken);

            _logger.LogInformation("GovtReportDistributor created successfully with ID: {Id}", entity.ID);

            return Result<long>.Success(entity.ID);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error creating GovtReportDistributor");
            throw;
        }
    }
}
