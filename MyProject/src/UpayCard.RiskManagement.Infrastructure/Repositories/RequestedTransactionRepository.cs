// <auto-generated>
//     This code was generated by TargCC.Core.Generators v2.0
//     Generated from table: dbo.RequestedTransaction
//     Generation date: 2025-12-16 21:06:06
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

namespace UpayCard.RiskManagement.Infrastructure.Repositories;

using System.Data;
using System.Threading;
using System.Threading.Tasks;
using Dapper;
using Microsoft.Extensions.Logging;
using UpayCard.RiskManagement.Domain.Entities;
using UpayCard.RiskManagement.Domain.Interfaces;

/// <summary>
/// Repository implementation for RequestedTransaction entity data access operations.
/// </summary>
/// <remarks>
/// <para>
/// This repository provides data access for the RequestedTransaction entity using Dapper
/// for stored procedure calls. All operations are async and support cancellation.
/// </para>
/// </remarks>
public class RequestedTransactionRepository : IRequestedTransactionRepository
{
    private readonly IDbConnection _connection;
    private readonly ILogger<RequestedTransactionRepository> _logger;

    /// <summary>
    /// Initializes a new instance of the <see cref="RequestedTransactionRepository"/> class.
    /// </summary>
    /// <param name="connection">Database connection for Dapper operations.</param>
    /// <param name="logger">Logger for tracking repository operations.</param>
    public RequestedTransactionRepository(IDbConnection connection, ILogger<RequestedTransactionRepository> logger)
    {
        _connection = connection ?? throw new ArgumentNullException(nameof(connection));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<RequestedTransaction?> GetByIdAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("RequestedTransaction found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetAllAsync(int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting all RequestedTransaction entities. Skip: {Skip}, Take: {Take}", skip, take);

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetAllRequestedTransactions",
                new { Skip = skip, Take = take },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting all RequestedTransaction entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetFilteredAsync(string? codeToGiveChanger = null, long? creditCardID = null, DateTime? dateRequested = null, string? enmDepositLocation = null, long? distributorID = null, long? groupRequestedTransactionID = null, long? initiatingCustomerID = null, string? enmStatus_RequestedTransactionStatus = null, DateTimeOffset? whenStatusChanged = null, string? enmType_RequestedTransactionType = null, long? loggedAlertID = null, DateTime? monthRequested = null, long? targetNonCustomerID = null, long? payingCustomerID = null, long? prepaidCardID = null, long? receivingCustomerID = null, long? targetCustomerID = null, string? enmDirection_TransactionDirection = null, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting filtered RequestedTransaction entities");

        try
        {
            var parameters = new {
                CodeToGiveChanger = codeToGiveChanger,
                CreditCardID = creditCardID,
                clc_DateRequested = dateRequested,
                enmDepositLocation = enmDepositLocation,
                DistributorID = distributorID,
                GroupRequestedTransactionID = groupRequestedTransactionID,
                InitiatingCustomerID = initiatingCustomerID,
                spt_enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus,
                clc_WhenStatusChanged = whenStatusChanged,
                enmType_RequestedTransactionType = enmType_RequestedTransactionType,
                LoggedAlertID = loggedAlertID,
                clc_MonthRequested = monthRequested,
                TargetNonCustomerID = targetNonCustomerID,
                PayingCustomerID = payingCustomerID,
                PrepaidCardID = prepaidCardID,
                ReceivingCustomerID = receivingCustomerID,
                TargetCustomerID = targetCustomerID,
                enmDirection_TransactionDirection = enmDirection_TransactionDirection,
                Skip = skip,
                Take = take
            };

            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetFilteredRequestedTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} filtered RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting filtered RequestedTransaction entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task AddAsync(RequestedTransaction entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Adding new RequestedTransaction");

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@TableName_RequestedTransaction", entity.TableName_RequestedTransaction);
            parameters.Add("@InitiatingCustomerID", entity.InitiatingCustomerID);
            parameters.Add("@TargetCustomerID", entity.TargetCustomerID);
            parameters.Add("@TargetCustomerEmailOrPhone", entity.TargetCustomerEmailOrPhone);
            parameters.Add("@TargetCustomerName", entity.TargetCustomerName);
            parameters.Add("@CustomerTransactionDescription", entity.CustomerTransactionDescription);
            parameters.Add("@enmDirection_TransactionDirection", entity.enmDirection_TransactionDirection);
            parameters.Add("@enmType_RequestedTransactionType", entity.enmType_RequestedTransactionType);
            parameters.Add("@enmFeePayer_Payer", entity.enmFeePayer_Payer);
            parameters.Add("@DefiningAmount", entity.DefiningAmount);
            parameters.Add("@CreditCardID", entity.CreditCardID);
            parameters.Add("@AmountPaidByCreditCard", entity.AmountPaidByCreditCard);
            parameters.Add("@NumberOfPaymentsByCreditCard", entity.NumberOfPaymentsByCreditCard);
            parameters.Add("@FirstPaymentAmountByCreditCard", entity.FirstPaymentAmountByCreditCard);
            parameters.Add("@OtherPaymentsAmountByCreditCard", entity.OtherPaymentsAmountByCreditCard);
            parameters.Add("@AmountPaidByBit", entity.AmountPaidByBit);
            parameters.Add("@AmountPaidByWallet", entity.AmountPaidByWallet);
            parameters.Add("@TotalAmountPaidByPayer", entity.TotalAmountPaidByPayer);
            parameters.Add("@AmountReceivedByReceiver", entity.AmountReceivedByReceiver);
            parameters.Add("@lkpDefiningAmountCurrency_Currency", entity.lkpDefiningAmountCurrency_Currency);
            parameters.Add("@PrepaidCardID", entity.PrepaidCardID);
            parameters.Add("@DistributorID", entity.DistributorID);
            parameters.Add("@enmDepositLocation", entity.enmDepositLocation);
            parameters.Add("@CodeToGiveChanger", entity.CodeToGiveChanger);
            parameters.Add("@spt_enmStatus_RequestedTransactionStatus", entity.enmStatus_RequestedTransactionStatusSeparate);
            parameters.Add("@LoggedAlertID", entity.LoggedAlertID);
            parameters.Add("@ErrorText", entity.ErrorText);
            parameters.Add("@spt_Comments", entity.CommentsSeparate);
            parameters.Add("@DeletedBy", entity.DeletedBy);
            parameters.Add("@DeletedOn", entity.DeletedOn);
            parameters.Add("@UpdatingLoginID", entity.UpdatingLoginID);
            parameters.Add("@SecurityCodeApproved", entity.SecurityCodeApproved);
            parameters.Add("@InitiatingCustomerEmailOrPhone", entity.InitiatingCustomerEmailOrPhone);
            parameters.Add("@InitiatingCustomerName", entity.InitiatingCustomerName);
            parameters.Add("@ExchangeRateToILSUsed", entity.ExchangeRateToILSUsed);
            parameters.Add("@TargetNonCustomerID", entity.TargetNonCustomerID);
            parameters.Add("@GroupRequestedTransactionID", entity.GroupRequestedTransactionID);
            parameters.Add("@ReceivingCustomerID", entity.ReceivingCustomerID);
            parameters.Add("@PayingCustomerID", entity.PayingCustomerID);
            parameters.Add("@RepExchangeRateToILS", entity.RepExchangeRateToILS);
            parameters.Add("@DefiningAmountILS", entity.DefiningAmountILS);
            parameters.Add("@AddedBy", entity.AddedBy);

            await _connection.ExecuteAsync(
                "SP_AddRequestedTransaction",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("RequestedTransaction added successfully");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error adding RequestedTransaction");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task UpdateAsync(RequestedTransaction entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Updating RequestedTransaction with ID: {Id}", entity.ID);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", entity.ID);
            parameters.Add("@TableName_RequestedTransaction", entity.TableName_RequestedTransaction);
            parameters.Add("@InitiatingCustomerID", entity.InitiatingCustomerID);
            parameters.Add("@TargetCustomerID", entity.TargetCustomerID);
            parameters.Add("@TargetCustomerEmailOrPhone", entity.TargetCustomerEmailOrPhone);
            parameters.Add("@TargetCustomerName", entity.TargetCustomerName);
            parameters.Add("@CustomerTransactionDescription", entity.CustomerTransactionDescription);
            parameters.Add("@enmDirection_TransactionDirection", entity.enmDirection_TransactionDirection);
            parameters.Add("@enmType_RequestedTransactionType", entity.enmType_RequestedTransactionType);
            parameters.Add("@enmFeePayer_Payer", entity.enmFeePayer_Payer);
            parameters.Add("@DefiningAmount", entity.DefiningAmount);
            parameters.Add("@CreditCardID", entity.CreditCardID);
            parameters.Add("@AmountPaidByCreditCard", entity.AmountPaidByCreditCard);
            parameters.Add("@NumberOfPaymentsByCreditCard", entity.NumberOfPaymentsByCreditCard);
            parameters.Add("@FirstPaymentAmountByCreditCard", entity.FirstPaymentAmountByCreditCard);
            parameters.Add("@OtherPaymentsAmountByCreditCard", entity.OtherPaymentsAmountByCreditCard);
            parameters.Add("@AmountPaidByBit", entity.AmountPaidByBit);
            parameters.Add("@AmountPaidByWallet", entity.AmountPaidByWallet);
            parameters.Add("@TotalAmountPaidByPayer", entity.TotalAmountPaidByPayer);
            parameters.Add("@AmountReceivedByReceiver", entity.AmountReceivedByReceiver);
            parameters.Add("@lkpDefiningAmountCurrency_Currency", entity.lkpDefiningAmountCurrency_Currency);
            parameters.Add("@PrepaidCardID", entity.PrepaidCardID);
            parameters.Add("@DistributorID", entity.DistributorID);
            parameters.Add("@enmDepositLocation", entity.enmDepositLocation);
            parameters.Add("@CodeToGiveChanger", entity.CodeToGiveChanger);
            parameters.Add("@spt_enmStatus_RequestedTransactionStatus", entity.enmStatus_RequestedTransactionStatusSeparate);
            parameters.Add("@LoggedAlertID", entity.LoggedAlertID);
            parameters.Add("@ErrorText", entity.ErrorText);
            parameters.Add("@spt_Comments", entity.CommentsSeparate);
            parameters.Add("@DeletedBy", entity.DeletedBy);
            parameters.Add("@DeletedOn", entity.DeletedOn);
            parameters.Add("@UpdatingLoginID", entity.UpdatingLoginID);
            parameters.Add("@SecurityCodeApproved", entity.SecurityCodeApproved);
            parameters.Add("@InitiatingCustomerEmailOrPhone", entity.InitiatingCustomerEmailOrPhone);
            parameters.Add("@InitiatingCustomerName", entity.InitiatingCustomerName);
            parameters.Add("@ExchangeRateToILSUsed", entity.ExchangeRateToILSUsed);
            parameters.Add("@TargetNonCustomerID", entity.TargetNonCustomerID);
            parameters.Add("@GroupRequestedTransactionID", entity.GroupRequestedTransactionID);
            parameters.Add("@ReceivingCustomerID", entity.ReceivingCustomerID);
            parameters.Add("@PayingCustomerID", entity.PayingCustomerID);
            parameters.Add("@RepExchangeRateToILS", entity.RepExchangeRateToILS);
            parameters.Add("@DefiningAmountILS", entity.DefiningAmountILS);
            parameters.Add("@ChangedBy", entity.ChangedBy);

            await _connection.ExecuteAsync(
                "SP_UpdateRequestedTransaction",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("RequestedTransaction updated successfully. ID: {Id}", entity.ID);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error updating RequestedTransaction with ID: {Id}", entity.ID);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task DeleteAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Deleting RequestedTransaction with ID: {Id}", id);

        try
        {
            await _connection.ExecuteAsync(
                "SP_DeleteRequestedTransaction",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("RequestedTransaction deleted successfully. ID: {Id}", id);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error deleting RequestedTransaction with ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByCodeToGiveChangerAsync(string codeToGiveChanger, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by CodeToGiveChanger");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByCodeToGiveChanger",
                new { CodeToGiveChanger = codeToGiveChanger },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by CodeToGiveChanger");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByCreditCardIDAsync(long creditCardID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by CreditCardID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByCreditCardID",
                new { CreditCardID = creditCardID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by CreditCardID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByDateRequestedAsync(DateTime dateRequested, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by clc_DateRequested");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByDateRequested",
                new { DateRequested = dateRequested },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by clc_DateRequested");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByenmDepositLocationAsync(string enmDepositLocation, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by enmDepositLocation");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByenmDepositLocation",
                new { enmDepositLocation = enmDepositLocation },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by enmDepositLocation");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByDistributorIDAsync(long distributorID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by DistributorID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByDistributorID",
                new { DistributorID = distributorID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by DistributorID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByGroupRequestedTransactionIDAsync(long groupRequestedTransactionID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by GroupRequestedTransactionID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByGroupRequestedTransactionID",
                new { GroupRequestedTransactionID = groupRequestedTransactionID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by GroupRequestedTransactionID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByInitiatingCustomerIDAsync(long initiatingCustomerID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by InitiatingCustomerID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByInitiatingCustomerID",
                new { InitiatingCustomerID = initiatingCustomerID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by InitiatingCustomerID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByInitiatingCustomerIDAndenmStatus_RequestedTransactionStatusAsync(long initiatingCustomerID, string enmStatus_RequestedTransactionStatus, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by InitiatingCustomerID, spt_enmStatus_RequestedTransactionStatus");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByInitiatingCustomerIDAndenmStatus_RequestedTransactionStatus",
                new { InitiatingCustomerID = initiatingCustomerID, enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by InitiatingCustomerID, spt_enmStatus_RequestedTransactionStatus");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByInitiatingCustomerIDAndenmStatus_RequestedTransactionStatusAndWhenStatusChangedAsync(long initiatingCustomerID, string enmStatus_RequestedTransactionStatus, DateTimeOffset whenStatusChanged, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by InitiatingCustomerID, spt_enmStatus_RequestedTransactionStatus, clc_WhenStatusChanged");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByInitiatingCustomerIDAndenmStatus_RequestedTransactionStatusAndWhenStatusChanged",
                new { InitiatingCustomerID = initiatingCustomerID, enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus, WhenStatusChanged = whenStatusChanged },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by InitiatingCustomerID, spt_enmStatus_RequestedTransactionStatus, clc_WhenStatusChanged");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByInitiatingCustomerIDAndenmType_RequestedTransactionTypeAsync(long initiatingCustomerID, string enmType_RequestedTransactionType, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by InitiatingCustomerID, enmType_RequestedTransactionType");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByInitiatingCustomerIDAndenmType_RequestedTransactionType",
                new { InitiatingCustomerID = initiatingCustomerID, enmType_RequestedTransactionType = enmType_RequestedTransactionType },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by InitiatingCustomerID, enmType_RequestedTransactionType");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByInitiatingCustomerIDAndWhenStatusChangedAsync(long initiatingCustomerID, DateTimeOffset whenStatusChanged, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by InitiatingCustomerID, clc_WhenStatusChanged");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByInitiatingCustomerIDAndWhenStatusChanged",
                new { InitiatingCustomerID = initiatingCustomerID, WhenStatusChanged = whenStatusChanged },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by InitiatingCustomerID, clc_WhenStatusChanged");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByLoggedAlertIDAsync(long loggedAlertID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by LoggedAlertID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByLoggedAlertID",
                new { LoggedAlertID = loggedAlertID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by LoggedAlertID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByMonthRequestedAsync(DateTime monthRequested, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by clc_MonthRequested");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByMonthRequested",
                new { MonthRequested = monthRequested },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by clc_MonthRequested");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByTargetNonCustomerIDAsync(long targetNonCustomerID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by TargetNonCustomerID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByTargetNonCustomerID",
                new { TargetNonCustomerID = targetNonCustomerID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by TargetNonCustomerID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByPayingCustomerIDAsync(long payingCustomerID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by PayingCustomerID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByPayingCustomerID",
                new { PayingCustomerID = payingCustomerID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by PayingCustomerID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByPrepaidCardIDAsync(long prepaidCardID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by PrepaidCardID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByPrepaidCardID",
                new { PrepaidCardID = prepaidCardID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by PrepaidCardID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByReceivingCustomerIDAsync(long receivingCustomerID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by ReceivingCustomerID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByReceivingCustomerID",
                new { ReceivingCustomerID = receivingCustomerID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by ReceivingCustomerID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByenmStatus_RequestedTransactionStatusAsync(string enmStatus_RequestedTransactionStatus, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by spt_enmStatus_RequestedTransactionStatus");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByenmStatus_RequestedTransactionStatus",
                new { enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by spt_enmStatus_RequestedTransactionStatus");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByTargetCustomerIDAsync(long targetCustomerID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by TargetCustomerID");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByTargetCustomerID",
                new { TargetCustomerID = targetCustomerID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by TargetCustomerID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByTargetCustomerIDAndenmStatus_RequestedTransactionStatusAsync(long targetCustomerID, string enmStatus_RequestedTransactionStatus, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by TargetCustomerID, spt_enmStatus_RequestedTransactionStatus");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByTargetCustomerIDAndenmStatus_RequestedTransactionStatus",
                new { TargetCustomerID = targetCustomerID, enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by TargetCustomerID, spt_enmStatus_RequestedTransactionStatus");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByTargetCustomerIDAndenmStatus_RequestedTransactionStatusAndWhenStatusChangedAsync(long targetCustomerID, string enmStatus_RequestedTransactionStatus, DateTimeOffset whenStatusChanged, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by TargetCustomerID, spt_enmStatus_RequestedTransactionStatus, clc_WhenStatusChanged");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByTargetCustomerIDAndenmStatus_RequestedTransactionStatusAndWhenStatusChanged",
                new { TargetCustomerID = targetCustomerID, enmStatus_RequestedTransactionStatus = enmStatus_RequestedTransactionStatus, WhenStatusChanged = whenStatusChanged },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by TargetCustomerID, spt_enmStatus_RequestedTransactionStatus, clc_WhenStatusChanged");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByTargetCustomerIDAndWhenStatusChangedAsync(long targetCustomerID, DateTimeOffset whenStatusChanged, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by TargetCustomerID, clc_WhenStatusChanged");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByTargetCustomerIDAndWhenStatusChanged",
                new { TargetCustomerID = targetCustomerID, WhenStatusChanged = whenStatusChanged },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by TargetCustomerID, clc_WhenStatusChanged");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetByenmDirection_TransactionDirectionAsync(string enmDirection_TransactionDirection, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting RequestedTransaction by enmDirection_TransactionDirection");

        try
        {
            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByenmDirection_TransactionDirection",
                new { enmDirection_TransactionDirection = enmDirection_TransactionDirection },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} RequestedTransaction entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting RequestedTransaction by enmDirection_TransactionDirection");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<BackofficeTransaction>> GetBackofficeTransactionsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching BACKOFFICETRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<BackofficeTransaction>(
                "SP_GetRequestedTransactionBackofficeTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} BACKOFFICETRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching BACKOFFICETRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerWallet>> GetCustomerWalletsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERWALLETS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerWallet>(
                "SP_GetRequestedTransactionCustomerWallets",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERWALLETS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERWALLETS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<DrivebotPayment>> GetDrivebotPaymentsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching DRIVEBOTPAYMENTS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<DrivebotPayment>(
                "SP_GetRequestedTransactionDrivebotPayments",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} DRIVEBOTPAYMENTS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching DRIVEBOTPAYMENTS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<MCCBSecurityCheck>> GetMCCBSecurityChecksAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching MCCBSECURITYCHECKS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<MCCBSecurityCheck>(
                "SP_GetRequestedTransactionMCCBSecurityChecks",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} MCCBSECURITYCHECKS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching MCCBSECURITYCHECKS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<MCCBTransaction>> GetMCCBTransactionsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching MCCBTRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<MCCBTransaction>(
                "SP_GetRequestedTransactionMCCBTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} MCCBTRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching MCCBTRANSACTIONS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransactionFee>> GetRequestedTransactionFeesAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching REQUESTEDTRANSACTIONFEES for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<RequestedTransactionFee>(
                "SP_GetRequestedTransactionRequestedTransactionFees",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} REQUESTEDTRANSACTIONFEES for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching REQUESTEDTRANSACTIONFEES for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionBit>> GetTransactionBitsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONBITS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionBit>(
                "SP_GetRequestedTransactionTransactionBits",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONBITS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONBITS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionCreditCard>> GetTransactionCreditCardsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONCREDITCARDS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionCreditCard>(
                "SP_GetRequestedTransactionTransactionCreditCards",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONCREDITCARDS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONCREDITCARDS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionLoad>> GetTransactionLoadsAsync(long requestedTransactionId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONLOADS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", requestedTransactionId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionLoad>(
                "SP_GetRequestedTransactionTransactionLoads",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONLOADS for RequestedTransaction ID: {RequestedTransactionId}", result.Count(), requestedTransactionId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONLOADS for RequestedTransaction ID: {RequestedTransactionId}", requestedTransactionId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async Task<bool> ExistsAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Checking if RequestedTransaction exists with ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<RequestedTransaction>(
                "SP_GetRequestedTransactionByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            bool exists = result != null;
            _logger.LogDebug("RequestedTransaction exists: {Exists}", exists);
            return exists;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error checking if RequestedTransaction exists. ID: {Id}", id);
            throw;
        }
    }
}
