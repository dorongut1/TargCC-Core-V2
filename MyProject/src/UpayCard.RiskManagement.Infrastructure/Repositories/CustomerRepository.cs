// <auto-generated>
//     This code was generated by TargCC.Core.Generators v2.0
//     Generated from table: dbo.Customer
//     Generation date: 2025-12-16 10:02:27
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

namespace UpayCard.RiskManagement.Infrastructure.Repositories;

using System.Data;
using System.Threading;
using System.Threading.Tasks;
using Dapper;
using Microsoft.Extensions.Logging;
using UpayCard.RiskManagement.Domain.Entities;
using UpayCard.RiskManagement.Domain.Interfaces;

/// <summary>
/// Repository implementation for Customer entity data access operations.
/// </summary>
/// <remarks>
/// <para>
/// This repository provides data access for the Customer entity using Dapper
/// for stored procedure calls. All operations are async and support cancellation.
/// </para>
/// </remarks>
public class CustomerRepository : ICustomerRepository
{
    private readonly IDbConnection _connection;
    private readonly ILogger<CustomerRepository> _logger;

    /// <summary>
    /// Initializes a new instance of the <see cref="CustomerRepository"/> class.
    /// </summary>
    /// <param name="connection">Database connection for Dapper operations.</param>
    /// <param name="logger">Logger for tracking repository operations.</param>
    public CustomerRepository(IDbConnection connection, ILogger<CustomerRepository> logger)
    {
        _connection = connection ?? throw new ArgumentNullException(nameof(connection));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<Customer?> GetByIdAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<Customer>(
                "SP_GetCustomerByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Customer found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetAllAsync(int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting all Customer entities. Skip: {Skip}, Take: {Take}", skip, take);

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetAllCustomers",
                new { Skip = skip, Take = take },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting all Customer entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetFilteredAsync(long? assignedDistributorID = null, string? cellphoneNumber = null, string? customerIdentifier = null, DateTime? whenRegistered = null, string? enmBankDocumentationStatus_DocumentationStatus = null, long? customerClubID = null, string? enmCustomerType = null, string? enmIsOnTerrorList = null, bool? isEnabled = null, bool? businessLogoNeedsApproval = null, string? lastName = null, string? lastNameLatin = null, string? enmSecurityTier = null, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting filtered Customer entities");

        try
        {
            var parameters = new {
                AssignedDistributorID = assignedDistributorID,
                CellphoneNumber = cellphoneNumber,
                clc_CustomerIdentifier = customerIdentifier,
                clc_WhenRegistered = whenRegistered,
                spt_enmBankDocumentationStatus_DocumentationStatus = enmBankDocumentationStatus_DocumentationStatus,
                CustomerClubID = customerClubID,
                enmCustomerType = enmCustomerType,
                spt_enmIsOnTerrorList = enmIsOnTerrorList,
                spt_IsEnabled = isEnabled,
                spt_BusinessLogoNeedsApproval = businessLogoNeedsApproval,
                LastName = lastName,
                LastNameLatin = lastNameLatin,
                spt_enmSecurityTier = enmSecurityTier,
                Skip = skip,
                Take = take
            };

            var result = await _connection.QueryAsync<Customer>(
                "SP_GetFilteredCustomers",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} filtered Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting filtered Customer entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task AddAsync(Customer entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Adding new Customer");

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@TableName_Customer", entity.TableName_Customer);
            parameters.Add("@FirstName", entity.FirstName);
            parameters.Add("@LastName", entity.LastName);
            parameters.Add("@FirstNameLatin", entity.FirstNameLatin);
            parameters.Add("@LastNameLatin", entity.LastNameLatin);
            parameters.Add("@email", entity.email);
            parameters.Add("@BirthDate", entity.BirthDate);
            parameters.Add("@IsraelIDNumber", entity.IsraelIDNumber);
            parameters.Add("@lkpPassportCountry_Country", entity.lkpPassportCountry_Country);
            parameters.Add("@PassportNumber", entity.PassportNumber);
            parameters.Add("@DateIssued", entity.DateIssued);
            parameters.Add("@ExpiryDateObs", entity.ExpiryDateObs);
            parameters.Add("@CellphoneNumber", entity.CellphoneNumber);
            parameters.Add("@HomePhoneNumber", entity.HomePhoneNumber);
            parameters.Add("@ActualAddressNumber", entity.ActualAddressNumber);
            parameters.Add("@ActualAddressStreet", entity.ActualAddressStreet);
            parameters.Add("@ActualAddressCity", entity.ActualAddressCity);
            parameters.Add("@ActualZipCode", entity.ActualZipCode);
            parameters.Add("@MailAddressNumber", entity.MailAddressNumber);
            parameters.Add("@MailAddressStreet", entity.MailAddressStreet);
            parameters.Add("@MailAddressCity", entity.MailAddressCity);
            parameters.Add("@MailZipCode", entity.MailZipCode);
            parameters.Add("@enmGender", entity.enmGender);
            parameters.Add("@enmLanguage", entity.enmLanguage);
            parameters.Add("@spt_Comment", entity.CommentSeparate);
            parameters.Add("@spt_IsEnabled", entity.IsEnabledSeparate);
            parameters.Add("@IsEnabledChangedBy", entity.IsEnabledChangedBy);
            parameters.Add("@DeletedBy", entity.DeletedBy);
            parameters.Add("@DeletedOn", entity.DeletedOn);
            parameters.Add("@UpdatingLoginID", entity.UpdatingLoginID);
            parameters.Add("@spt_HasSignedServiceRequest", entity.HasSignedServiceRequestSeparate);
            parameters.Add("@lkpBank", entity.lkpBank);
            parameters.Add("@lkpBranch", entity.lkpBranch);
            parameters.Add("@BankAccount", entity.BankAccount);
            parameters.Add("@lkpSecretQuestion", entity.lkpSecretQuestion);
            parameters.Add("@entResponseToSecretQuestion", entity.entResponseToSecretQuestion);
            parameters.Add("@SAPAccountNumber", entity.SAPAccountNumber);
            parameters.Add("@enmMessagingMode", entity.enmMessagingMode);
            parameters.Add("@enmCustomerType", entity.enmCustomerType);
            parameters.Add("@spt_enmIsOnTerrorList", entity.enmIsOnTerrorListSeparate);
            parameters.Add("@spt_TerrorListUpdatedOn", entity.TerrorListUpdatedOnSeparate);
            parameters.Add("@UserPhoto", entity.UserPhoto);
            parameters.Add("@CustomerClubID", entity.CustomerClubID);
            parameters.Add("@AssignedDistributorID", entity.AssignedDistributorID);
            parameters.Add("@upl_TZFront", entity.TZFrontUpload);
            parameters.Add("@upl_TZBack", entity.TZBackUpload);
            parameters.Add("@upl_Passport", entity.PassportUpload);
            parameters.Add("@upl_Mugshot", entity.MugshotUpload);
            parameters.Add("@upl_ManiDocumentation", entity.ManiDocumentationUpload);
            parameters.Add("@ActualAddressApt", entity.ActualAddressApt);
            parameters.Add("@MailAddressApt", entity.MailAddressApt);
            parameters.Add("@entSecurityCode", entity.entSecurityCode);
            parameters.Add("@upl_BankDocumentation", entity.BankDocumentationUpload);
            parameters.Add("@spt_enmBankDocumentationStatus_DocumentationStatus", entity.enmBankDocumentationStatus_DocumentationStatusSeparate);
            parameters.Add("@Scratch", entity.Scratch);
            parameters.Add("@IsBusiness", entity.IsBusiness);
            parameters.Add("@BusinessName", entity.BusinessName);
            parameters.Add("@spt_enmBusinessDocumentationStatus_DocumentationStatus", entity.enmBusinessDocumentationStatus_DocumentationStatusSeparate);
            parameters.Add("@upl_LivenessVideo", entity.LivenessVideoUpload);
            parameters.Add("@upl_LivenessPicture", entity.LivenessPictureUpload);
            parameters.Add("@VerificationResults", entity.VerificationResults);
            parameters.Add("@OCRSuccess", entity.OCRSuccess);
            parameters.Add("@LivenessSuccess", entity.LivenessSuccess);
            parameters.Add("@BiometricMatchSuccess", entity.BiometricMatchSuccess);
            parameters.Add("@BiometricMatchScore", entity.BiometricMatchScore);
            parameters.Add("@IsRejected", entity.IsRejected);
            parameters.Add("@RejectedReason", entity.RejectedReason);
            parameters.Add("@upl_PaymentsDocumentation", entity.PaymentsDocumentationUpload);
            parameters.Add("@IPRegisteredFrom", entity.IPRegisteredFrom);
            parameters.Add("@upl_DLFront", entity.DLFrontUpload);
            parameters.Add("@upl_DLBack", entity.DLBackUpload);
            parameters.Add("@upl_FailedDocFront", entity.FailedDocFrontUpload);
            parameters.Add("@enmLastIDTypeRecd_IdentificationMethod", entity.enmLastIDTypeRecd_IdentificationMethod);
            parameters.Add("@upl_BusinessLogo", entity.BusinessLogoUpload);
            parameters.Add("@spt_enmSecurityTier", entity.enmSecurityTierSeparate);
            parameters.Add("@spt_BusinessLogoNeedsApproval", entity.BusinessLogoNeedsApprovalSeparate);
            parameters.Add("@spt_enmSecurityTierChangeStatus_DocumentationStatus", entity.enmSecurityTierChangeStatus_DocumentationStatusSeparate);
            parameters.Add("@upl_FailedDocBack", entity.FailedDocBackUpload);
            parameters.Add("@CaseNumber", entity.CaseNumber);
            parameters.Add("@FailedDocDetails", entity.FailedDocDetails);
            parameters.Add("@upl_FailedDocLivenessPicture", entity.FailedDocLivenessPictureUpload);
            parameters.Add("@upl_FailedDocLivenessVideo", entity.FailedDocLivenessVideoUpload);
            parameters.Add("@upl_FailedDocMugshot", entity.FailedDocMugshotUpload);
            parameters.Add("@ExpiryTZ", entity.ExpiryTZ);
            parameters.Add("@ExpiryPassport", entity.ExpiryPassport);
            parameters.Add("@ExpiryDL", entity.ExpiryDL);
            parameters.Add("@upl_BusinessDocumentation", entity.BusinessDocumentationUpload);
            parameters.Add("@ActualAddressStreetLatin", entity.ActualAddressStreetLatin);
            parameters.Add("@ActualAddressCityLatin", entity.ActualAddressCityLatin);
            parameters.Add("@AddedBy", entity.AddedBy);

            await _connection.ExecuteAsync(
                "SP_AddCustomer",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Customer added successfully");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error adding Customer");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task UpdateAsync(Customer entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Updating Customer with ID: {Id}", entity.ID);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", entity.ID);
            parameters.Add("@TableName_Customer", entity.TableName_Customer);
            parameters.Add("@FirstName", entity.FirstName);
            parameters.Add("@LastName", entity.LastName);
            parameters.Add("@FirstNameLatin", entity.FirstNameLatin);
            parameters.Add("@LastNameLatin", entity.LastNameLatin);
            parameters.Add("@email", entity.email);
            parameters.Add("@BirthDate", entity.BirthDate);
            parameters.Add("@IsraelIDNumber", entity.IsraelIDNumber);
            parameters.Add("@lkpPassportCountry_Country", entity.lkpPassportCountry_Country);
            parameters.Add("@PassportNumber", entity.PassportNumber);
            parameters.Add("@DateIssued", entity.DateIssued);
            parameters.Add("@ExpiryDateObs", entity.ExpiryDateObs);
            parameters.Add("@CellphoneNumber", entity.CellphoneNumber);
            parameters.Add("@HomePhoneNumber", entity.HomePhoneNumber);
            parameters.Add("@ActualAddressNumber", entity.ActualAddressNumber);
            parameters.Add("@ActualAddressStreet", entity.ActualAddressStreet);
            parameters.Add("@ActualAddressCity", entity.ActualAddressCity);
            parameters.Add("@ActualZipCode", entity.ActualZipCode);
            parameters.Add("@MailAddressNumber", entity.MailAddressNumber);
            parameters.Add("@MailAddressStreet", entity.MailAddressStreet);
            parameters.Add("@MailAddressCity", entity.MailAddressCity);
            parameters.Add("@MailZipCode", entity.MailZipCode);
            parameters.Add("@enmGender", entity.enmGender);
            parameters.Add("@enmLanguage", entity.enmLanguage);
            parameters.Add("@spt_Comment", entity.CommentSeparate);
            parameters.Add("@spt_IsEnabled", entity.IsEnabledSeparate);
            parameters.Add("@IsEnabledChangedBy", entity.IsEnabledChangedBy);
            parameters.Add("@DeletedBy", entity.DeletedBy);
            parameters.Add("@DeletedOn", entity.DeletedOn);
            parameters.Add("@UpdatingLoginID", entity.UpdatingLoginID);
            parameters.Add("@spt_HasSignedServiceRequest", entity.HasSignedServiceRequestSeparate);
            parameters.Add("@lkpBank", entity.lkpBank);
            parameters.Add("@lkpBranch", entity.lkpBranch);
            parameters.Add("@BankAccount", entity.BankAccount);
            parameters.Add("@lkpSecretQuestion", entity.lkpSecretQuestion);
            parameters.Add("@entResponseToSecretQuestion", entity.entResponseToSecretQuestion);
            parameters.Add("@SAPAccountNumber", entity.SAPAccountNumber);
            parameters.Add("@enmMessagingMode", entity.enmMessagingMode);
            parameters.Add("@enmCustomerType", entity.enmCustomerType);
            parameters.Add("@spt_enmIsOnTerrorList", entity.enmIsOnTerrorListSeparate);
            parameters.Add("@spt_TerrorListUpdatedOn", entity.TerrorListUpdatedOnSeparate);
            parameters.Add("@UserPhoto", entity.UserPhoto);
            parameters.Add("@CustomerClubID", entity.CustomerClubID);
            parameters.Add("@AssignedDistributorID", entity.AssignedDistributorID);
            parameters.Add("@upl_TZFront", entity.TZFrontUpload);
            parameters.Add("@upl_TZBack", entity.TZBackUpload);
            parameters.Add("@upl_Passport", entity.PassportUpload);
            parameters.Add("@upl_Mugshot", entity.MugshotUpload);
            parameters.Add("@upl_ManiDocumentation", entity.ManiDocumentationUpload);
            parameters.Add("@ActualAddressApt", entity.ActualAddressApt);
            parameters.Add("@MailAddressApt", entity.MailAddressApt);
            parameters.Add("@entSecurityCode", entity.entSecurityCode);
            parameters.Add("@upl_BankDocumentation", entity.BankDocumentationUpload);
            parameters.Add("@spt_enmBankDocumentationStatus_DocumentationStatus", entity.enmBankDocumentationStatus_DocumentationStatusSeparate);
            parameters.Add("@Scratch", entity.Scratch);
            parameters.Add("@IsBusiness", entity.IsBusiness);
            parameters.Add("@BusinessName", entity.BusinessName);
            parameters.Add("@spt_enmBusinessDocumentationStatus_DocumentationStatus", entity.enmBusinessDocumentationStatus_DocumentationStatusSeparate);
            parameters.Add("@upl_LivenessVideo", entity.LivenessVideoUpload);
            parameters.Add("@upl_LivenessPicture", entity.LivenessPictureUpload);
            parameters.Add("@VerificationResults", entity.VerificationResults);
            parameters.Add("@OCRSuccess", entity.OCRSuccess);
            parameters.Add("@LivenessSuccess", entity.LivenessSuccess);
            parameters.Add("@BiometricMatchSuccess", entity.BiometricMatchSuccess);
            parameters.Add("@BiometricMatchScore", entity.BiometricMatchScore);
            parameters.Add("@IsRejected", entity.IsRejected);
            parameters.Add("@RejectedReason", entity.RejectedReason);
            parameters.Add("@upl_PaymentsDocumentation", entity.PaymentsDocumentationUpload);
            parameters.Add("@IPRegisteredFrom", entity.IPRegisteredFrom);
            parameters.Add("@upl_DLFront", entity.DLFrontUpload);
            parameters.Add("@upl_DLBack", entity.DLBackUpload);
            parameters.Add("@upl_FailedDocFront", entity.FailedDocFrontUpload);
            parameters.Add("@enmLastIDTypeRecd_IdentificationMethod", entity.enmLastIDTypeRecd_IdentificationMethod);
            parameters.Add("@upl_BusinessLogo", entity.BusinessLogoUpload);
            parameters.Add("@spt_enmSecurityTier", entity.enmSecurityTierSeparate);
            parameters.Add("@spt_BusinessLogoNeedsApproval", entity.BusinessLogoNeedsApprovalSeparate);
            parameters.Add("@spt_enmSecurityTierChangeStatus_DocumentationStatus", entity.enmSecurityTierChangeStatus_DocumentationStatusSeparate);
            parameters.Add("@upl_FailedDocBack", entity.FailedDocBackUpload);
            parameters.Add("@CaseNumber", entity.CaseNumber);
            parameters.Add("@FailedDocDetails", entity.FailedDocDetails);
            parameters.Add("@upl_FailedDocLivenessPicture", entity.FailedDocLivenessPictureUpload);
            parameters.Add("@upl_FailedDocLivenessVideo", entity.FailedDocLivenessVideoUpload);
            parameters.Add("@upl_FailedDocMugshot", entity.FailedDocMugshotUpload);
            parameters.Add("@ExpiryTZ", entity.ExpiryTZ);
            parameters.Add("@ExpiryPassport", entity.ExpiryPassport);
            parameters.Add("@ExpiryDL", entity.ExpiryDL);
            parameters.Add("@upl_BusinessDocumentation", entity.BusinessDocumentationUpload);
            parameters.Add("@ActualAddressStreetLatin", entity.ActualAddressStreetLatin);
            parameters.Add("@ActualAddressCityLatin", entity.ActualAddressCityLatin);
            parameters.Add("@ChangedBy", entity.ChangedBy);

            await _connection.ExecuteAsync(
                "SP_UpdateCustomer",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Customer updated successfully. ID: {Id}", entity.ID);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error updating Customer with ID: {Id}", entity.ID);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task DeleteAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Deleting Customer with ID: {Id}", id);

        try
        {
            await _connection.ExecuteAsync(
                "SP_DeleteCustomer",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Customer deleted successfully. ID: {Id}", id);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error deleting Customer with ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<Customer?> GetByAssignedDistributorIDAsync(long assignedDistributorID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by AssignedDistributorID");

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<Customer>(
                "SP_GetCustomerByAssignedDistributorID",
                new { AssignedDistributorID = assignedDistributorID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Customer found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by AssignedDistributorID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<Customer?> GetByCellphoneNumberAsync(string cellphoneNumber, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by CellphoneNumber");

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<Customer>(
                "SP_GetCustomerByCellphoneNumber",
                new { CellphoneNumber = cellphoneNumber },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Customer found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by CellphoneNumber");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<Customer?> GetByCustomerIdentifierAsync(string customerIdentifier, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by clc_CustomerIdentifier");

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<Customer>(
                "SP_GetCustomerByCustomerIdentifier",
                new { CustomerIdentifier = customerIdentifier },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Customer found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by clc_CustomerIdentifier");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByWhenRegisteredAsync(DateTime whenRegistered, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by clc_WhenRegistered");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByWhenRegistered",
                new { WhenRegistered = whenRegistered },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by clc_WhenRegistered");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByenmBankDocumentationStatus_DocumentationStatusAsync(string enmBankDocumentationStatus_DocumentationStatus, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by spt_enmBankDocumentationStatus_DocumentationStatus");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByenmBankDocumentationStatus_DocumentationStatus",
                new { enmBankDocumentationStatus_DocumentationStatus = enmBankDocumentationStatus_DocumentationStatus },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by spt_enmBankDocumentationStatus_DocumentationStatus");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByCustomerClubIDAsync(long customerClubID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by CustomerClubID");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByCustomerClubID",
                new { CustomerClubID = customerClubID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by CustomerClubID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByenmCustomerTypeAsync(string enmCustomerType, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by enmCustomerType");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByenmCustomerType",
                new { enmCustomerType = enmCustomerType },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by enmCustomerType");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByenmIsOnTerrorListAsync(string enmIsOnTerrorList, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by spt_enmIsOnTerrorList");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByenmIsOnTerrorList",
                new { enmIsOnTerrorList = enmIsOnTerrorList },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by spt_enmIsOnTerrorList");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByIsEnabledAsync(bool isEnabled, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by spt_IsEnabled");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByIsEnabled",
                new { IsEnabled = isEnabled },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by spt_IsEnabled");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByBusinessLogoNeedsApprovalAsync(bool businessLogoNeedsApproval, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by spt_BusinessLogoNeedsApproval");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByBusinessLogoNeedsApproval",
                new { BusinessLogoNeedsApproval = businessLogoNeedsApproval },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by spt_BusinessLogoNeedsApproval");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByLastNameAsync(string lastName, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by LastName");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByLastName",
                new { LastName = lastName },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by LastName");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByLastNameLatinAsync(string lastNameLatin, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by LastNameLatin");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByLastNameLatin",
                new { LastNameLatin = lastNameLatin },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by LastNameLatin");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Customer>> GetByenmSecurityTierAsync(string enmSecurityTier, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting Customer by spt_enmSecurityTier");

        try
        {
            var result = await _connection.QueryAsync<Customer>(
                "SP_GetCustomerByenmSecurityTier",
                new { enmSecurityTier = enmSecurityTier },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} Customer entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting Customer by spt_enmSecurityTier");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<BackofficeTransaction>> GetBackofficeTransactionsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching BACKOFFICETRANSACTIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<BackofficeTransaction>(
                "SP_GetCustomerBackofficeTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} BACKOFFICETRANSACTIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching BACKOFFICETRANSACTIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<Card>> GetCardsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CARDS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<Card>(
                "SP_GetCustomerCards",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CARDS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CARDS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CardActivation>> GetCardActivationsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CARDACTIVATIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CardActivation>(
                "SP_GetCustomerCardActivations",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CARDACTIVATIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CARDACTIVATIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CardClub>> GetCardClubsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CARDCLUBS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CardClub>(
                "SP_GetCustomerCardClubs",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CARDCLUBS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CARDCLUBS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerCardTransaction>> GetCustomerCardTransactionsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERCARDTRANSACTIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerCardTransaction>(
                "SP_GetCustomerCustomerCardTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERCARDTRANSACTIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERCARDTRANSACTIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerCreditCard>> GetCustomerCreditCardsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERCREDITCARDS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerCreditCard>(
                "SP_GetCustomerCustomerCreditCards",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERCREDITCARDS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERCREDITCARDS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerKYC>> GetCustomerKYCsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERKYCS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerKYC>(
                "SP_GetCustomerCustomerKYCs",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERKYCS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERKYCS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerPartnership>> GetCustomerPartnershipsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERPARTNERSHIPS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerPartnership>(
                "SP_GetCustomerCustomerPartnerships",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERPARTNERSHIPS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERPARTNERSHIPS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerPerformance>> GetCustomerPerformancesAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERPERFORMANCES for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerPerformance>(
                "SP_GetCustomerCustomerPerformances",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERPERFORMANCES for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERPERFORMANCES for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CustomerWallet>> GetCustomerWalletsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CUSTOMERWALLETS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CustomerWallet>(
                "SP_GetCustomerCustomerWallets",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CUSTOMERWALLETS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CUSTOMERWALLETS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<DrivebotPayment>> GetDrivebotPaymentsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching DRIVEBOTPAYMENTS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<DrivebotPayment>(
                "SP_GetCustomerDrivebotPayments",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} DRIVEBOTPAYMENTS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching DRIVEBOTPAYMENTS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<ExternalCustomer>> GetExternalCustomersAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching EXTERNALCUSTOMERS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<ExternalCustomer>(
                "SP_GetCustomerExternalCustomers",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} EXTERNALCUSTOMERS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching EXTERNALCUSTOMERS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<ExternalTransaction>> GetExternalTransactionsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching EXTERNALTRANSACTIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<ExternalTransaction>(
                "SP_GetCustomerExternalTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} EXTERNALTRANSACTIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching EXTERNALTRANSACTIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<ImportTransactionLoadRow>> GetImportTransactionLoadRowsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching IMPORTTRANSACTIONLOADROWS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<ImportTransactionLoadRow>(
                "SP_GetCustomerImportTransactionLoadRows",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} IMPORTTRANSACTIONLOADROWS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching IMPORTTRANSACTIONLOADROWS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<MCCBReceiver>> GetMCCBReceiversAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching MCCBRECEIVERS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<MCCBReceiver>(
                "SP_GetCustomerMCCBReceivers",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} MCCBRECEIVERS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching MCCBRECEIVERS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<MCCBSecurityCheck>> GetMCCBSecurityChecksAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching MCCBSECURITYCHECKS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<MCCBSecurityCheck>(
                "SP_GetCustomerMCCBSecurityChecks",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} MCCBSECURITYCHECKS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching MCCBSECURITYCHECKS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<MCCBTransaction>> GetMCCBTransactionsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching MCCBTRANSACTIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<MCCBTransaction>(
                "SP_GetCustomerMCCBTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} MCCBTRANSACTIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching MCCBTRANSACTIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<NewCardRequest>> GetNewCardRequestsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching NEWCARDREQUESTS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<NewCardRequest>(
                "SP_GetCustomerNewCardRequests",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} NEWCARDREQUESTS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching NEWCARDREQUESTS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<OnlineApproval>> GetOnlineApprovalsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching ONLINEAPPROVALS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<OnlineApproval>(
                "SP_GetCustomerOnlineApprovals",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} ONLINEAPPROVALS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching ONLINEAPPROVALS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetRequestedTransactionsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching REQUESTEDTRANSACTIONS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetCustomerRequestedTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} REQUESTEDTRANSACTIONS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching REQUESTEDTRANSACTIONS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<UpayCard.RiskManagement.Domain.Entities.Task>> GetTasksAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TASKS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<UpayCard.RiskManagement.Domain.Entities.Task>(
                "SP_GetCustomerTasks",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TASKS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TASKS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionBit>> GetTransactionBitsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONBITS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionBit>(
                "SP_GetCustomerTransactionBits",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONBITS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONBITS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionCreditCard>> GetTransactionCreditCardsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONCREDITCARDS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionCreditCard>(
                "SP_GetCustomerTransactionCreditCards",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONCREDITCARDS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONCREDITCARDS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionLoad>> GetTransactionLoadsAsync(long customerId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONLOADS for Customer ID: {CustomerId}", customerId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", customerId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionLoad>(
                "SP_GetCustomerTransactionLoads",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONLOADS for Customer ID: {CustomerId}", result.Count(), customerId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONLOADS for Customer ID: {CustomerId}", customerId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async Task<bool> ExistsAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Checking if Customer exists with ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<Customer>(
                "SP_GetCustomerByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            bool exists = result != null;
            _logger.LogDebug("Customer exists: {Exists}", exists);
            return exists;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error checking if Customer exists. ID: {Id}", id);
            throw;
        }
    }
}
