// <auto-generated>
//     This code was generated by TargCC.Core.Generators v2.0
//     Generated from table: dbo.c_LoggedAlert
//     Generation date: 2025-12-18 07:30:14
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

namespace UpayCard.RiskManagement.Infrastructure.Repositories;

using System.Data;
using System.Threading;
using System.Threading.Tasks;
using Dapper;
using Microsoft.Extensions.Logging;
using UpayCard.RiskManagement.Domain.Entities;
using UpayCard.RiskManagement.Domain.Interfaces;

/// <summary>
/// Repository implementation for LoggedAlert entity data access operations.
/// </summary>
/// <remarks>
/// <para>
/// This repository provides data access for the LoggedAlert entity using Dapper
/// for stored procedure calls. All operations are async and support cancellation.
/// </para>
/// </remarks>
public class LoggedAlertRepository : ILoggedAlertRepository
{
    private readonly IDbConnection _connection;
    private readonly ILogger<LoggedAlertRepository> _logger;

    /// <summary>
    /// Initializes a new instance of the <see cref="LoggedAlertRepository"/> class.
    /// </summary>
    /// <param name="connection">Database connection for Dapper operations.</param>
    /// <param name="logger">Logger for tracking repository operations.</param>
    public LoggedAlertRepository(IDbConnection connection, ILogger<LoggedAlertRepository> logger)
    {
        _connection = connection ?? throw new ArgumentNullException(nameof(connection));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<LoggedAlert?> GetByIdAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<LoggedAlert>(
                "SP_GetLoggedAlertByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("LoggedAlert found: {Found}", result != null);
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetAllAsync(int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting all LoggedAlert entities. Skip: {Skip}, Take: {Take}", skip, take);

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetAllLoggedAlerts",
                new { Skip = skip, Take = take },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting all LoggedAlert entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetFilteredAsync(string? callingApplication = null, DateTime? dateOccurred = null, int? faultNumber = null, string? enmFaultSeverity_FaultSeverity = null, string? enmFaultType_FaultType = null, long? c_LoggedLoginID = null, DateTime? monthOccurred = null, string? systemName = null, DateTime? timeOccurred = null, long? affectedUserID = null, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting filtered LoggedAlert entities");

        try
        {
            var parameters = new {
                CallingApplication = callingApplication,
                clc_DateOccurred = dateOccurred,
                FaultNumber = faultNumber,
                enmFaultSeverity_FaultSeverity = enmFaultSeverity_FaultSeverity,
                enmFaultType_FaultType = enmFaultType_FaultType,
                c_LoggedLoginID = c_LoggedLoginID,
                clc_MonthOccurred = monthOccurred,
                SystemName = systemName,
                TimeOccurred = timeOccurred,
                AffectedUserID = affectedUserID,
                Skip = skip,
                Take = take
            };

            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetFilteredLoggedAlerts",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} filtered LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting filtered LoggedAlert entities");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task AddAsync(LoggedAlert entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Adding new LoggedAlert");

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@TimeOccurred", entity.TimeOccurred);
            parameters.Add("@FaultNumber", entity.FaultNumber);
            parameters.Add("@SystemName", entity.SystemName);
            parameters.Add("@CallingApplication", entity.CallingApplication);
            parameters.Add("@AffectedUserID", entity.AffectedUserID);
            parameters.Add("@CallingApplicationVersion", entity.CallingApplicationVersion);
            parameters.Add("@CallingFunctionWithinApplication", entity.CallingFunctionWithinApplication);
            parameters.Add("@FreeText", entity.FreeText);
            parameters.Add("@FaultingAssembly", entity.FaultingAssembly);
            parameters.Add("@AssemblyEntryPoint", entity.AssemblyEntryPoint);
            parameters.Add("@FaultingClass", entity.FaultingClass);
            parameters.Add("@FaultingFunction", entity.FaultingFunction);
            parameters.Add("@FaultingFunctionParameters", entity.FaultingFunctionParameters);
            parameters.Add("@FaultIdent", entity.FaultIdent);
            parameters.Add("@FaultDescription", entity.FaultDescription);
            parameters.Add("@MessageSentToUser", entity.MessageSentToUser);
            parameters.Add("@ActionSentToUser", entity.ActionSentToUser);
            parameters.Add("@enmFaultType_FaultType", entity.enmFaultType_FaultType);
            parameters.Add("@enmFaultSeverity_FaultSeverity", entity.enmFaultSeverity_FaultSeverity);
            parameters.Add("@c_LoggedLoginID", entity.c_LoggedLoginID);
            parameters.Add("@Thread", entity.Thread);
            parameters.Add("@lkpUserIdentityType", entity.lkpUserIdentityType);
            parameters.Add("@lkpUserIdentityTypeName", entity.lkpUserIdentityTypeName);

            await _connection.ExecuteAsync(
                "SP_AddLoggedAlert",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("LoggedAlert added successfully");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error adding LoggedAlert");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task UpdateAsync(LoggedAlert entity, CancellationToken cancellationToken = default)
    {
        if (entity == null)
        {
            throw new ArgumentNullException(nameof(entity));
        }

        _logger.LogDebug("Updating LoggedAlert with ID: {Id}", entity.ID);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", entity.ID);
            parameters.Add("@TimeOccurred", entity.TimeOccurred);
            parameters.Add("@FaultNumber", entity.FaultNumber);
            parameters.Add("@SystemName", entity.SystemName);
            parameters.Add("@CallingApplication", entity.CallingApplication);
            parameters.Add("@AffectedUserID", entity.AffectedUserID);
            parameters.Add("@CallingApplicationVersion", entity.CallingApplicationVersion);
            parameters.Add("@CallingFunctionWithinApplication", entity.CallingFunctionWithinApplication);
            parameters.Add("@FreeText", entity.FreeText);
            parameters.Add("@FaultingAssembly", entity.FaultingAssembly);
            parameters.Add("@AssemblyEntryPoint", entity.AssemblyEntryPoint);
            parameters.Add("@FaultingClass", entity.FaultingClass);
            parameters.Add("@FaultingFunction", entity.FaultingFunction);
            parameters.Add("@FaultingFunctionParameters", entity.FaultingFunctionParameters);
            parameters.Add("@FaultIdent", entity.FaultIdent);
            parameters.Add("@FaultDescription", entity.FaultDescription);
            parameters.Add("@MessageSentToUser", entity.MessageSentToUser);
            parameters.Add("@ActionSentToUser", entity.ActionSentToUser);
            parameters.Add("@enmFaultType_FaultType", entity.enmFaultType_FaultType);
            parameters.Add("@enmFaultSeverity_FaultSeverity", entity.enmFaultSeverity_FaultSeverity);
            parameters.Add("@c_LoggedLoginID", entity.c_LoggedLoginID);
            parameters.Add("@Thread", entity.Thread);
            parameters.Add("@lkpUserIdentityType", entity.lkpUserIdentityType);
            parameters.Add("@lkpUserIdentityTypeName", entity.lkpUserIdentityTypeName);

            await _connection.ExecuteAsync(
                "SP_UpdateLoggedAlert",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("LoggedAlert updated successfully. ID: {Id}", entity.ID);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error updating LoggedAlert with ID: {Id}", entity.ID);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task DeleteAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Deleting LoggedAlert with ID: {Id}", id);

        try
        {
            await _connection.ExecuteAsync(
                "SP_DeleteLoggedAlert",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("LoggedAlert deleted successfully. ID: {Id}", id);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error deleting LoggedAlert with ID: {Id}", id);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByCallingApplicationAsync(string callingApplication, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by CallingApplication");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByCallingApplication",
                new { CallingApplication = callingApplication },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by CallingApplication");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByDateOccurredAsync(DateTime dateOccurred, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by clc_DateOccurred");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByDateOccurred",
                new { DateOccurred = dateOccurred },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by clc_DateOccurred");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByFaultNumberAsync(int faultNumber, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by FaultNumber");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByFaultNumber",
                new { FaultNumber = faultNumber },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by FaultNumber");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByenmFaultSeverity_FaultSeverityAsync(string enmFaultSeverity_FaultSeverity, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by enmFaultSeverity_FaultSeverity");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByenmFaultSeverity_FaultSeverity",
                new { enmFaultSeverity_FaultSeverity = enmFaultSeverity_FaultSeverity },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by enmFaultSeverity_FaultSeverity");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByenmFaultType_FaultTypeAsync(string enmFaultType_FaultType, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by enmFaultType_FaultType");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByenmFaultType_FaultType",
                new { enmFaultType_FaultType = enmFaultType_FaultType },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by enmFaultType_FaultType");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByenmFaultType_FaultTypeAndenmFaultSeverity_FaultSeverityAsync(string enmFaultType_FaultType, string enmFaultSeverity_FaultSeverity, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by enmFaultType_FaultType, enmFaultSeverity_FaultSeverity");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByenmFaultType_FaultTypeAndenmFaultSeverity_FaultSeverity",
                new { enmFaultType_FaultType = enmFaultType_FaultType, enmFaultSeverity_FaultSeverity = enmFaultSeverity_FaultSeverity },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by enmFaultType_FaultType, enmFaultSeverity_FaultSeverity");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByc_LoggedLoginIDAsync(long c_LoggedLoginID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by c_LoggedLoginID");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByc_LoggedLoginID",
                new { c_LoggedLoginID = c_LoggedLoginID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by c_LoggedLoginID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByMonthOccurredAsync(DateTime monthOccurred, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by clc_MonthOccurred");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByMonthOccurred",
                new { MonthOccurred = monthOccurred },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by clc_MonthOccurred");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetBySystemNameAsync(string systemName, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by SystemName");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertBySystemName",
                new { SystemName = systemName },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by SystemName");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByTimeOccurredAsync(DateTime timeOccurred, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by TimeOccurred");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByTimeOccurred",
                new { TimeOccurred = timeOccurred },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by TimeOccurred");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByTimeOccurredAndenmFaultType_FaultTypeAndenmFaultSeverity_FaultSeverityAsync(DateTime timeOccurred, string enmFaultType_FaultType, string enmFaultSeverity_FaultSeverity, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by TimeOccurred, enmFaultType_FaultType, enmFaultSeverity_FaultSeverity");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByTimeOccurredAndenmFaultType_FaultTypeAndenmFaultSeverity_FaultSeverity",
                new { TimeOccurred = timeOccurred, enmFaultType_FaultType = enmFaultType_FaultType, enmFaultSeverity_FaultSeverity = enmFaultSeverity_FaultSeverity },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by TimeOccurred, enmFaultType_FaultType, enmFaultSeverity_FaultSeverity");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedAlert>> GetByAffectedUserIDAsync(long affectedUserID, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Getting LoggedAlert by AffectedUserID");

        try
        {
            var result = await _connection.QueryAsync<LoggedAlert>(
                "SP_GetLoggedAlertByAffectedUserID",
                new { AffectedUserID = affectedUserID },
                commandType: CommandType.StoredProcedure);

            _logger.LogDebug("Retrieved {Count} LoggedAlert entities", result.Count());
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error getting LoggedAlert by AffectedUserID");
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<LoggedJob>> Getc_LoggedJobsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching C_LOGGEDJOBS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<LoggedJob>(
                "SP_GetLoggedAlertc_LoggedJobs",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} C_LOGGEDJOBS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching C_LOGGEDJOBS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<CardOrderFromIssuer>> GetCardOrderFromIssuersAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching CARDORDERFROMISSUERS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<CardOrderFromIssuer>(
                "SP_GetLoggedAlertCardOrderFromIssuers",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} CARDORDERFROMISSUERS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching CARDORDERFROMISSUERS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<ImportTransactionLoadRow>> GetImportTransactionLoadRowsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching IMPORTTRANSACTIONLOADROWS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<ImportTransactionLoadRow>(
                "SP_GetLoggedAlertImportTransactionLoadRows",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} IMPORTTRANSACTIONLOADROWS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching IMPORTTRANSACTIONLOADROWS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<NewCardRequest>> GetNewCardRequestsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching NEWCARDREQUESTS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<NewCardRequest>(
                "SP_GetLoggedAlertNewCardRequests",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} NEWCARDREQUESTS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching NEWCARDREQUESTS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<NewCardRequestAPI>> GetNewCardRequestAPIsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching NEWCARDREQUESTAPIS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<NewCardRequestAPI>(
                "SP_GetLoggedAlertNewCardRequestAPIs",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} NEWCARDREQUESTAPIS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching NEWCARDREQUESTAPIS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<RequestedTransaction>> GetRequestedTransactionsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching REQUESTEDTRANSACTIONS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<RequestedTransaction>(
                "SP_GetLoggedAlertRequestedTransactions",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} REQUESTEDTRANSACTIONS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching REQUESTEDTRANSACTIONS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async System.Threading.Tasks.Task<IEnumerable<TransactionLoad>> GetTransactionLoadsAsync(long loggedAlertId, int? skip = null, int? take = null, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Fetching TRANSACTIONLOADS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);

        try
        {
            var parameters = new DynamicParameters();
            parameters.Add("@ID", loggedAlertId);
            parameters.Add("@Skip", skip);
            parameters.Add("@Take", take);

            var result = await _connection.QueryAsync<TransactionLoad>(
                "SP_GetLoggedAlertTransactionLoads",
                parameters,
                commandType: CommandType.StoredProcedure);

            _logger.LogInformation("Retrieved {Count} TRANSACTIONLOADS for LoggedAlert ID: {LoggedAlertId}", result.Count(), loggedAlertId);

            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error fetching TRANSACTIONLOADS for LoggedAlert ID: {LoggedAlertId}", loggedAlertId);
            throw;
        }
    }

    /// <inheritdoc/>
    public async Task<bool> ExistsAsync(long id, CancellationToken cancellationToken = default)
    {
        _logger.LogDebug("Checking if LoggedAlert exists with ID: {Id}", id);

        try
        {
            var result = await _connection.QueryFirstOrDefaultAsync<LoggedAlert>(
                "SP_GetLoggedAlertByID",
                new { ID = id },
                commandType: CommandType.StoredProcedure);

            bool exists = result != null;
            _logger.LogDebug("LoggedAlert exists: {Exists}", exists);
            return exists;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error checking if LoggedAlert exists. ID: {Id}", id);
            throw;
        }
    }
}
