// ------------------------------------------------------------------------------
// <auto-generated>
//     This file is part of TargCC.Core.Generators
//     Copyright (c) 2024-2025 TargCC. All rights reserved.
// </auto-generated>
// ------------------------------------------------------------------------------

#nullable enable

namespace TargCC.Core.Generators.Project.Models;

/// <summary>
/// Represents information about a generated solution.
/// </summary>
public class SolutionInfo
{
    /// <summary>
    /// Gets or sets the solution name.
    /// </summary>
    public required string Name { get; set; }

    /// <summary>
    /// Gets or sets the solution GUID.
    /// </summary>
    public Guid SolutionGuid { get; set; } = Guid.NewGuid();

    /// <summary>
    /// Gets or sets the output directory.
    /// </summary>
    public required string OutputDirectory { get; set; }

    /// <summary>
    /// Gets or sets the list of projects in the solution.
    /// </summary>
    public List<ProjectInfo> Projects { get; set; } = new();

    /// <summary>
    /// Gets or sets the solution folders.
    /// </summary>
    public List<SolutionFolder> Folders { get; set; } = new();

    /// <summary>
    /// Gets the solution file name.
    /// </summary>
    public string SlnFileName => $"{Name}.sln";

    /// <summary>
    /// Gets the full solution path.
    /// </summary>
    public string SlnPath => Path.Combine(OutputDirectory, SlnFileName);
}

/// <summary>
/// Represents a solution folder.
/// </summary>
public class SolutionFolder
{
    /// <summary>
    /// Gets or sets the folder name.
    /// </summary>
    public required string Name { get; set; }

    /// <summary>
    /// Gets or sets the folder GUID.
    /// </summary>
    public Guid FolderGuid { get; set; } = Guid.NewGuid();

    /// <summary>
    /// Gets or sets the list of project GUIDs in this folder.
    /// </summary>
    public List<Guid> ProjectGuids { get; set; } = new();

    /// <summary>
    /// Solution folder type GUID (constant for VS).
    /// </summary>
    public static readonly Guid SolutionFolderTypeGuid = new("2150E333-8FDC-42A3-9474-1A3956D46DE8");
}

/// <summary>
/// Result of solution generation.
/// </summary>
public class SolutionGenerationResult
{
    /// <summary>
    /// Gets or sets a value indicating whether generation was successful.
    /// </summary>
    public bool Success { get; set; }

    /// <summary>
    /// Gets or sets the solution info.
    /// </summary>
    public SolutionInfo? SolutionInfo { get; set; }

    /// <summary>
    /// Gets or sets error message if failed.
    /// </summary>
    public string? ErrorMessage { get; set; }

    /// <summary>
    /// Gets or sets the list of generated file paths.
    /// </summary>
    public List<string> GeneratedFiles { get; set; } = new();

    /// <summary>
    /// Gets or sets generation duration.
    /// </summary>
    public TimeSpan Duration { get; set; }
}
